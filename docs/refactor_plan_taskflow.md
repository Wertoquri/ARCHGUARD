# План рефакторингу — короткий (taskflow)

Цей документ дає практичні, маленькі кроки для зниження архітектурного ризику в двох вузьких місцях, виявлених ARCHGUARD.

1) `src/context/AuthContext.jsx` — fan-in = 11 (потенційний вузький модуль)

- Мета: зменшити кількість модулів, що напряму залежні від `AuthContext`.
- Кроки:
  1. Додати тонкий adapter/абстракцію `src/context/authApi.js` з чітким API (login, logout, getUser).
  2. Замінити прямі імпорти `AuthContext` в 3–4 найбільш простих споживачах на імпорт `authApi`.
  3. Створити набор unit-тестів для `authApi` (мокувати контекст).
  4. Поступово перемістити інші споживачі — мінімальний PR за один-дві файли.
  5. Після стабілізації — розглянути split-пакети або lazy-load для рідко використовуваних API.

Причина: adapter знижує поверхню API та дозволяє поступовий рефакторинг без глобальних змін.

2) `src/api.js` — fan-in = 16 (центральна точка доступу до бекенду)

- Мета: зменшити накопичення залежностей, виділити фасад і стабілізувати контракти.
- Кроки:
  1. Проаналізувати найбільш часті точки виклику в `findings_taskflow.json` (які модулі імпортують `src/api.js`).
  2. Винести менш важливі або рідко використовувані методи в окремі модулі (наприклад `src/api/notifications.js`).
  3. Для загальних функцій створити `src/api/facade.js` з мінімальним стабільним інтерфейсом.
  4. Застосувати інструментальні тести щоб перевіряти backward-compat для споживачів.
  5. Проводити рефакторинг поетапно, кожен крок — окремий PR з тестами.

Метрики успіху:
- Падіння fan-in під поріг політики (R-002 або R-007).
- Кількість модулів, що напряму імпортують центральний модуль, знизиться на 30–50%.

---
Цей план — практичний дорожній набір кроків; можу згенерувати чергові PR-дифі для перших двох файлів, якщо дасте підтвердження.
